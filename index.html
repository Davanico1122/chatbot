<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chatbot AI</title>
  <link rel="stylesheet" href="chatbot-modern-dark.css">
</head>
<body>
  <div style="padding: 40px; text-align: center;">
    <h1>🤖 Chatbot AI by Davanico</h1>
    <p>Modern, responsive, and offline chatbot for your website.</p>
    <p>Click the chat button below to try it out!</p>
  </div>

  <!-- ===== Chatbot Toggle Button ===== -->
  <button class="chatbot-toggle" onclick="toggleChatbot()">💬</button>

  <!-- ===== Chatbot Container ===== -->
  <div class="chatbot-container" id="chatbot" style="display: none;">
    <!-- === Language Selector === -->
    <div class="chatbot-lang">
      <label for="languageSelect">🌐</label>
      <select id="languageSelect" onchange="changeLanguage()">
        <option value="id">🇮🇩 ID</option>
        <option value="en">🇺🇸 EN</option>
      </select>
    </div>

    <!-- === Chatbot Header === -->
    <div class="chatbot-header">AI Assistant</div>

    <!-- === Chat Messages === -->
    <div class="chat-messages" id="chatMessages">
      <div class="message bot">
        <div class="message-bubble">Halo! Saya AI Assistant. Ada yang bisa saya bantu? 😊</div>
      </div>
    </div>

    <!-- === Input Area === -->
    <div class="chat-input">
      <input 
        type="text" 
        id="messageInput" 
        placeholder="Ketik pesan..." 
        onkeypress="handleKeyPress(event)" 
        autocomplete="off">
      <button onclick="sendMessage()">➔</button>
    </div>
  </div>

  <!-- === Script Order === -->
  <script src="getBotResponse-id.js"></script>
  <script src="getBotResponse-en.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const chatbot = document.getElementById('chatbot');
      const chatMessages = document.getElementById('chatMessages');
      const messageInput = document.getElementById('messageInput');
      const languageSelect = document.getElementById('languageSelect') || { value: 'id' };

      window.toggleChatbot = function () {
        chatbot.style.display = chatbot.style.display === 'none' || chatbot.style.display === '' ? 'flex' : 'none';
      }

      function addMessage(text, sender = 'bot') {
        const msgDiv = document.createElement('div');
        msgDiv.className = `message ${sender}`;
        const bubble = document.createElement('div');
        bubble.className = 'message-bubble';
        bubble.textContent = '';
        msgDiv.appendChild(bubble);
        chatMessages.appendChild(msgDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;

        if (sender === 'bot') {
          let i = 0;
          const typing = setInterval(() => {
            if (i < text.length) {
              bubble.textContent += text.charAt(i);
              i++;
            } else {
              clearInterval(typing);
            }
          }, 25);
        } else {
          bubble.textContent = text;
        }
      }

      window.sendMessage = function () {
        const msg = messageInput.value.trim();
        if (!msg) return;

        addMessage(msg, 'user');
        messageInput.value = '';

        setTimeout(() => {
          const lang = languageSelect.value || 'id';
          let response = '';

          try {
            response = lang === 'id' ? getBotResponseID(msg) : getBotResponseEN(msg);
          } catch (err) {
            response = "Oops, bot gagal menjawab. Periksa file responnya!";
            console.error("Error getting bot response:", err);
          }

          addMessage(response, 'bot');
        }, 500);
      }

      window.handleKeyPress = function (e) {
        if (e.key === 'Enter') sendMessage();
      }

      window.changeLanguage = function () {
        const lang = languageSelect.value;
        const greeting = lang === 'id'
          ? "Halo! Saya AI Assistant. Ada yang bisa saya bantu? 😊"
          : "Hello! I'm your AI Assistant. How can I help you? 😊";

        chatMessages.innerHTML = '';
        addMessage(greeting, 'bot');
      }
    });
  </script>
</body>
</html>
